(* ::Package:: *)

(* ::Text:: *)
(*\[Copyright] 2011-2023 Emerald Cloud Lab, Inc.*)


(* ::Title:: *)
(*Peaks: Tests*)


(* ::Section:: *)
(*Unit Testing*)


(* ::Subsection::Closed:: *)
(*Peak Picking*)


(* ::Subsection::Closed:: *)
(*AdvancedAnalyzePeaks*)


(* ::Subsubsection::Closed:: *)
(*AdvancedAnalyzePeaks*)


DefineTests[AdvancedAnalyzePeaks, {

	Test["No options produces no peak:",
		Lookup[AdvancedAnalyzePeaks[xyPts, Upload->False],Replace[Position]], 
		{}
	],
	Test["No options uploads:",
		AdvancedAnalyzePeaks[xyPts, Upload->True], 
		ObjectP[Object[Analysis,Peaks]]
	],
	Test["Specify manual peaks:",
		Lookup[AdvancedAnalyzePeaks[xyPts, ManualPeaks -> {{{200,0},{250,1}}},Upload->False],
		Map[Replace,{Position,PeakRangeStart, PeakRangeEnd, BaselineSlope}]], 
		{{239.14},{198.512}, {250.221},{1/(250.221-198.512)}}, 
		EquivalenceFunction -> RoundMatchQ[5]
	],
	Test["Specify threshold:",
		Lookup[AdvancedAnalyzePeaks[xyPts,PeakThresholds -> {{{50, 150}, 1500}},Upload->False],
		Map[Replace,{Position,PeakRangeStart, PeakRangeEnd, BaselineSlope}]], 
		{{65.8685, 117.254}, {50.8673, 101.02}, {79.8291, 143.109}, {19.5453, -7.5668}},
		EquivalenceFunction -> RoundMatchQ[5]
	],
	Test["Specify labels:",
		Lookup[AdvancedAnalyzePeaks[xyPts, 
  			ManualPeaks -> {{{200, 0}, {250, 0}}}, 
  			PeakThresholds -> {{{50, 150}, 1500}},
  			ExpectedPeaks -> {{"Aaa", 117, {115, 120}}, {"Bbb", 239, {235, 245}}}, Upload -> False], 
 			Map[Replace, {PeakLabel, Position}]
		],
		(* can't lable manual (for now) *)
		{{"Manual 2", "Automatic 1-1", "Aaa"}, {239.14, 65.8685, 117.254}},
		EquivalenceFunction -> RoundMatchQ[5]
	]
	
},

	Variables:>{xyPts,logLinearData,xyPtsUnits},
	SetUp:>(
		xyPts={{-60.4703`,1.587`},{-59.8914`,-2.9288`},{-59.3126`,-2.8543`},{-58.7337`,-3.6064`},{-58.1548`,-3.5293`},{-57.5759`,-7.4673`},{-56.9971`,0.8248`},{-56.4182`,23.293`},{-55.8393`,0.3193`},{-55.2604`,-13.9593`},{-54.6816`,-12.3607`},{-54.1027`,-3.2422`},{-53.5238`,-4.832`},{-52.9449`,-8.3469`},{-52.3661`,-14.6887`},{-51.7872`,-17.8354`},{-51.2083`,-11.4492`},{-50.6294`,-13.8761`},{-50.0505`,-7.6376`},{-49.4717`,-20.6722`},{-48.8928`,-6.1023`},{-48.3139`,-3.0062`},{-47.735`,6.8016`},{-47.1562`,23.4155`},{-46.5773`,0.9423`},{-45.9984`,19.5976`},{-45.4195`,0.8777`},{-44.8407`,2.3731`},{-44.2618`,16.3106`},{-43.6829`,4.7338`},{-43.104`,7.0143`},{-42.5252`,-0.4604`},{-41.9463`,16.6188`},{-41.3674`,-7.5774`},{-40.7885`,4.786`},{-40.2096`,9.1225`},{-39.6308`,6.0894`},{-39.0519`,8.1521`},{-38.473`,0.7713`},{-37.8941`,24.0671`},{-37.3153`,-5.3851`},{-36.7364`,7.6461`},{-36.1575`,6.2401`},{-35.5786`,5.5707`},{-34.9998`,-3.8426`},{-34.4209`,-8.1403`},{-33.842`,4.7625`},{-33.2631`,-11.033`},{-32.6843`,-10.0288`},{-32.1054`,-9.4915`},{-31.5265`,6.0948`},{-30.9476`,22.7781`},{-30.3687`,-18.0986`},{-29.7899`,-5.7582`},{-29.211`,-7.9967`},{-28.6321`,17.574`},{-28.0532`,9.6356`},{-27.4744`,-12.3885`},{-26.8955`,-9.992`},{-26.3166`,-8.0265`},{-25.7377`,-6.8299`},{-25.1589`,-8.0575`},{-24.58`,9.9059`},{-24.0011`,4.6671`},{-23.4222`,29.4874`},{-22.8434`,-5.0773`},{-22.2645`,3.1678`},{-21.6856`,-3.0654`},{-21.1067`,-4.1394`},{-20.5278`,-12.4577`},{-19.949`,-7.0589`},{-19.3701`,-10.7888`},{-18.7912`,4.4065`},{-18.2123`,5.4024`},{-17.6335`,6.2734`},{-17.0546`,-4.4128`},{-16.4757`,9.1531`},{-15.8968`,-17.4617`},{-15.318`,-5.7665`},{-14.7391`,-8.6346`},{-14.1602`,-1.6776`},{-13.5813`,5.549`},{-13.0025`,-1.2764`},{-12.4236`,1.6277`},{-11.8447`,-6.2084`},{-11.2658`,5.6592`},{-10.6869`,4.7049`},{-10.1081`,8.8459`},{-9.5292`,-5.952`},{-8.9503`,14.4889`},{-8.3714`,23.2175`},{-7.7926`,21.225`},{-7.2137`,15.7654`},{-6.6348`,-2.578`},{-6.0559`,8.965`},{-5.4771`,-9.7285`},{-4.8982`,-2.9533`},{-4.3193`,75.6051`},{-3.7404`,16.4113`},{-3.1616`,14.9865`},{-2.5827`,-11.3331`},{-2.0038`,-2.0928`},{-1.4249`,-0.9202`},{-0.846`,0.2394`},{-0.2672`,6.0783`},{0.3117`,12.7922`},{0.8906`,149.8234`},{1.4695`,137.478`},{2.0483`,73.5309`},{2.6272`,20.1371`},{3.2061`,13.3703`},{3.785`,-1.6624`},{4.3638`,-5.3309`},{4.9427`,6.2866`},{5.5216`,-4.5244`},{6.1005`,-15.892`},{6.6793`,-17.247`},{7.2582`,-3.521`},{7.8371`,47.9696`},{8.416`,48.6575`},{8.9949`,143.0855`},{9.5737`,262.487`},{10.1526`,433.1576`},{10.7315`,655.7522`},{11.3104`,789.8354`},{11.8892`,812.2174`},{12.4681`,768.5621`},{13.047`,657.1636`},{13.6259`,473.0125`},{14.2047`,347.134`},{14.7836`,228.5908`},{15.3625`,146.17`},{15.9414`,77.1921`},{16.5202`,93.6922`},{17.0991`,41.6889`},{17.678`,34.9402`},{18.2569`,24.9377`},{18.8358`,6.303`},{19.4146`,7.6878`},{19.9935`,-0.4913`},{20.5724`,4.309`},{21.1513`,7.6213`},{21.7301`,14.0376`},{22.309`,10.5065`},{22.8879`,-5.2162`},{23.4668`,3.6696`},{24.0456`,-1.3919`},{24.6245`,13.7266`},{25.2034`,26.7292`},{25.7823`,-0.9272`},{26.3611`,-5.163`},{26.94`,-2.0984`},{27.5189`,-4.7001`},{28.0978`,-15.0261`},{28.6767`,-6.6703`},{29.2555`,-4.7324`},{29.8344`,-9.1476`},{30.4133`,-11.197`},{30.9922`,-18.8589`},{31.571`,-18.5209`},{32.1499`,-7.7127`},{32.7288`,-17.283`},{33.3077`,10.2485`},{33.8865`,0.7054`},{34.4654`,17.6433`},{35.0443`,26.3025`},{35.6232`,-4.1029`},{36.202`,9.6538`},{36.7809`,50.4171`},{37.3598`,71.2644`},{37.9387`,193.1155`},{38.5176`,510.2275`},{39.0964`,954.8649`},{39.6753`,1316.5008`},{40.5055`,1341.1692`},{41.6568`,1026.4138`},{42.8081`,549.0985`},{43.9595`,223.7178`},{45.1108`,34.8255`},{46.2621`,-25.6132`},{47.4134`,-69.3664`},{48.5647`,-100.2309`},{49.716`,-90.0365`},{50.8673`,-110.048`},{52.0186`,-89.8928`},{53.1699`,-70.6448`},{54.3212`,-66.6014`},{55.4725`,-7.3808`},{56.6238`,24.2758`},{57.7751`,44.6924`},{58.9264`,89.7889`},{60.0777`,151.1335`},{61.229`,290.8439`},{62.3803`,536.4023`},{63.5317`,956.7083`},{64.683`,1382.7361`},{65.8685`,1552.8259`},{68.4379`,1408.1517`},{71.2857`,1056.4687`},{74.1335`,772.6727`},{76.9813`,502.9082`},{79.8291`,456.0177`},{82.6769`,597.0413`},{85.5247`,933.6729`},{88.3726`,1140.7761`},{91.3774`,1132.9723`},{94.5917`,934.8548`},{97.8059`,695.1553`},{101.0202`,506.9661`},{104.2344`,526.7152`},{107.4487`,886.2472`},{110.6629`,1485.9208`},{113.8772`,1962.2649`},{117.2542`,1986.5373`},{120.9477`,1602.6262`},{124.6412`,1052.4658`},{128.3347`,520.8706`},{132.0283`,237.5131`},{135.7218`,179.6594`},{139.4153`,194.352`},{143.1088`,188.4899`},{146.8023`,193.5516`},{150.4959`,149.3122`},{154.1894`,68.9806`},{157.8829`,26.3029`},{161.5764`,32.2454`},{165.2699`,82.5101`},{168.9635`,171.1333`},{172.657`,342.7152`},{176.3505`,529.9803`},{180.044`,653.1731`},{183.7376`,523.2293`},{187.4311`,361.8707`},{191.1246`,167.4945`},{194.8181`,61.7772`},{198.5116`,60.4075`},{202.2052`,35.8679`},{205.8987`,44.0184`},{209.5922`,65.031`},{213.2857`,95.5418`},{216.9792`,120.0814`},{220.6728`,175.8616`},{224.3663`,244.9024`},{228.0598`,308.0053`},{231.7533`,342.9063`},{235.4469`,388.0488`},{239.1404`,402.7888`},{242.8339`,364.4319`},{246.5274`,337.8086`},{250.2209`,229.8374`},{253.9145`,156.6267`},{257.608`,33.2384`},{261.3015`,-62.4133`},{264.995`,-107.0692`},{268.6885`,-145.7654`},{272.3821`,-167.8836`},{276.0756`,-174.4012`},{279.7691`,-160.7985`},{283.4626`,-94.334`},{287.1562`,-132.8897`},{290.8497`,-88.0442`},{294.5432`,-24.0263`},{298.2367`,17.0242`},{301.9302`,39.8069`},{305.6238`,53.6636`},{309.3173`,58.9873`},{313.0108`,23.7347`},{316.7043`,-15.399`},{320.3978`,-13.7185`},{324.0914`,-29.1139`},{327.7849`,-37.6242`},{331.4784`,-40.0249`},{335.1719`,-26.3684`},{338.8654`,-21.9221`},{342.559`,-23.7979`},{346.2525`,-14.4608`},{349.946`,-0.908`},{353.6395`,-8.8529`},{357.3331`,-8.4405`}};
	)
];


(* ::Subsubsection::Closed:: *)
(*AdvancedAnalyzePeaksOptions*)


DefineTests[AdvancedAnalyzePeaksOptions, {

	Example[{Basic, "Resolve options for chromatography data:"},
		AdvancedAnalyzePeaksOptions[Object[Data, Chromatography, "id:XnlV5jmbk0rn"]],
		_Grid
	],

	Example[{Basic,"Resolve options for list of chromatography data:"},
		AdvancedAnalyzePeaksOptions[{Object[Data, Chromatography, "id:XnlV5jmbk0rn"],Object[Data, Chromatography, "id:XnlV5jmbk0rn"],Object[Data, Chromatography, "id:XnlV5jmbk0rn"]}],
		_Grid
	],

	Example[{Basic, "Resolve options for raw numeric data:"},
		AdvancedAnalyzePeaksOptions[xyPts],
		_Grid
	]
	},

	Variables:>{xyPts},
	SetUp:>(
		xyPts={{-60.4703`,1.587`},{-59.8914`,-2.9288`},{-59.3126`,-2.8543`},{-58.7337`,-3.6064`},{-58.1548`,-3.5293`},{-57.5759`,-7.4673`},{-56.9971`,0.8248`},{-56.4182`,23.293`},{-55.8393`,0.3193`},{-55.2604`,-13.9593`},{-54.6816`,-12.3607`},{-54.1027`,-3.2422`},{-53.5238`,-4.832`},{-52.9449`,-8.3469`},{-52.3661`,-14.6887`},{-51.7872`,-17.8354`},{-51.2083`,-11.4492`},{-50.6294`,-13.8761`},{-50.0505`,-7.6376`},{-49.4717`,-20.6722`},{-48.8928`,-6.1023`},{-48.3139`,-3.0062`},{-47.735`,6.8016`},{-47.1562`,23.4155`},{-46.5773`,0.9423`},{-45.9984`,19.5976`},{-45.4195`,0.8777`},{-44.8407`,2.3731`},{-44.2618`,16.3106`},{-43.6829`,4.7338`},{-43.104`,7.0143`},{-42.5252`,-0.4604`},{-41.9463`,16.6188`},{-41.3674`,-7.5774`},{-40.7885`,4.786`},{-40.2096`,9.1225`},{-39.6308`,6.0894`},{-39.0519`,8.1521`},{-38.473`,0.7713`},{-37.8941`,24.0671`},{-37.3153`,-5.3851`},{-36.7364`,7.6461`},{-36.1575`,6.2401`},{-35.5786`,5.5707`},{-34.9998`,-3.8426`},{-34.4209`,-8.1403`},{-33.842`,4.7625`},{-33.2631`,-11.033`},{-32.6843`,-10.0288`},{-32.1054`,-9.4915`},{-31.5265`,6.0948`},{-30.9476`,22.7781`},{-30.3687`,-18.0986`},{-29.7899`,-5.7582`},{-29.211`,-7.9967`},{-28.6321`,17.574`},{-28.0532`,9.6356`},{-27.4744`,-12.3885`},{-26.8955`,-9.992`},{-26.3166`,-8.0265`},{-25.7377`,-6.8299`},{-25.1589`,-8.0575`},{-24.58`,9.9059`},{-24.0011`,4.6671`},{-23.4222`,29.4874`},{-22.8434`,-5.0773`},{-22.2645`,3.1678`},{-21.6856`,-3.0654`},{-21.1067`,-4.1394`},{-20.5278`,-12.4577`},{-19.949`,-7.0589`},{-19.3701`,-10.7888`},{-18.7912`,4.4065`},{-18.2123`,5.4024`},{-17.6335`,6.2734`},{-17.0546`,-4.4128`},{-16.4757`,9.1531`},{-15.8968`,-17.4617`},{-15.318`,-5.7665`},{-14.7391`,-8.6346`},{-14.1602`,-1.6776`},{-13.5813`,5.549`},{-13.0025`,-1.2764`},{-12.4236`,1.6277`},{-11.8447`,-6.2084`},{-11.2658`,5.6592`},{-10.6869`,4.7049`},{-10.1081`,8.8459`},{-9.5292`,-5.952`},{-8.9503`,14.4889`},{-8.3714`,23.2175`},{-7.7926`,21.225`},{-7.2137`,15.7654`},{-6.6348`,-2.578`},{-6.0559`,8.965`},{-5.4771`,-9.7285`},{-4.8982`,-2.9533`},{-4.3193`,75.6051`},{-3.7404`,16.4113`},{-3.1616`,14.9865`},{-2.5827`,-11.3331`},{-2.0038`,-2.0928`},{-1.4249`,-0.9202`},{-0.846`,0.2394`},{-0.2672`,6.0783`},{0.3117`,12.7922`},{0.8906`,149.8234`},{1.4695`,137.478`},{2.0483`,73.5309`},{2.6272`,20.1371`},{3.2061`,13.3703`},{3.785`,-1.6624`},{4.3638`,-5.3309`},{4.9427`,6.2866`},{5.5216`,-4.5244`},{6.1005`,-15.892`},{6.6793`,-17.247`},{7.2582`,-3.521`},{7.8371`,47.9696`},{8.416`,48.6575`},{8.9949`,143.0855`},{9.5737`,262.487`},{10.1526`,433.1576`},{10.7315`,655.7522`},{11.3104`,789.8354`},{11.8892`,812.2174`},{12.4681`,768.5621`},{13.047`,657.1636`},{13.6259`,473.0125`},{14.2047`,347.134`},{14.7836`,228.5908`},{15.3625`,146.17`},{15.9414`,77.1921`},{16.5202`,93.6922`},{17.0991`,41.6889`},{17.678`,34.9402`},{18.2569`,24.9377`},{18.8358`,6.303`},{19.4146`,7.6878`},{19.9935`,-0.4913`},{20.5724`,4.309`},{21.1513`,7.6213`},{21.7301`,14.0376`},{22.309`,10.5065`},{22.8879`,-5.2162`},{23.4668`,3.6696`},{24.0456`,-1.3919`},{24.6245`,13.7266`},{25.2034`,26.7292`},{25.7823`,-0.9272`},{26.3611`,-5.163`},{26.94`,-2.0984`},{27.5189`,-4.7001`},{28.0978`,-15.0261`},{28.6767`,-6.6703`},{29.2555`,-4.7324`},{29.8344`,-9.1476`},{30.4133`,-11.197`},{30.9922`,-18.8589`},{31.571`,-18.5209`},{32.1499`,-7.7127`},{32.7288`,-17.283`},{33.3077`,10.2485`},{33.8865`,0.7054`},{34.4654`,17.6433`},{35.0443`,26.3025`},{35.6232`,-4.1029`},{36.202`,9.6538`},{36.7809`,50.4171`},{37.3598`,71.2644`},{37.9387`,193.1155`},{38.5176`,510.2275`},{39.0964`,954.8649`},{39.6753`,1316.5008`},{40.5055`,1341.1692`},{41.6568`,1026.4138`},{42.8081`,549.0985`},{43.9595`,223.7178`},{45.1108`,34.8255`},{46.2621`,-25.6132`},{47.4134`,-69.3664`},{48.5647`,-100.2309`},{49.716`,-90.0365`},{50.8673`,-110.048`},{52.0186`,-89.8928`},{53.1699`,-70.6448`},{54.3212`,-66.6014`},{55.4725`,-7.3808`},{56.6238`,24.2758`},{57.7751`,44.6924`},{58.9264`,89.7889`},{60.0777`,151.1335`},{61.229`,290.8439`},{62.3803`,536.4023`},{63.5317`,956.7083`},{64.683`,1382.7361`},{65.8685`,1552.8259`},{68.4379`,1408.1517`},{71.2857`,1056.4687`},{74.1335`,772.6727`},{76.9813`,502.9082`},{79.8291`,456.0177`},{82.6769`,597.0413`},{85.5247`,933.6729`},{88.3726`,1140.7761`},{91.3774`,1132.9723`},{94.5917`,934.8548`},{97.8059`,695.1553`},{101.0202`,506.9661`},{104.2344`,526.7152`},{107.4487`,886.2472`},{110.6629`,1485.9208`},{113.8772`,1962.2649`},{117.2542`,1986.5373`},{120.9477`,1602.6262`},{124.6412`,1052.4658`},{128.3347`,520.8706`},{132.0283`,237.5131`},{135.7218`,179.6594`},{139.4153`,194.352`},{143.1088`,188.4899`},{146.8023`,193.5516`},{150.4959`,149.3122`},{154.1894`,68.9806`},{157.8829`,26.3029`},{161.5764`,32.2454`},{165.2699`,82.5101`},{168.9635`,171.1333`},{172.657`,342.7152`},{176.3505`,529.9803`},{180.044`,653.1731`},{183.7376`,523.2293`},{187.4311`,361.8707`},{191.1246`,167.4945`},{194.8181`,61.7772`},{198.5116`,60.4075`},{202.2052`,35.8679`},{205.8987`,44.0184`},{209.5922`,65.031`},{213.2857`,95.5418`},{216.9792`,120.0814`},{220.6728`,175.8616`},{224.3663`,244.9024`},{228.0598`,308.0053`},{231.7533`,342.9063`},{235.4469`,388.0488`},{239.1404`,402.7888`},{242.8339`,364.4319`},{246.5274`,337.8086`},{250.2209`,229.8374`},{253.9145`,156.6267`},{257.608`,33.2384`},{261.3015`,-62.4133`},{264.995`,-107.0692`},{268.6885`,-145.7654`},{272.3821`,-167.8836`},{276.0756`,-174.4012`},{279.7691`,-160.7985`},{283.4626`,-94.334`},{287.1562`,-132.8897`},{290.8497`,-88.0442`},{294.5432`,-24.0263`},{298.2367`,17.0242`},{301.9302`,39.8069`},{305.6238`,53.6636`},{309.3173`,58.9873`},{313.0108`,23.7347`},{316.7043`,-15.399`},{320.3978`,-13.7185`},{324.0914`,-29.1139`},{327.7849`,-37.6242`},{331.4784`,-40.0249`},{335.1719`,-26.3684`},{338.8654`,-21.9221`},{342.559`,-23.7979`},{346.2525`,-14.4608`},{349.946`,-0.908`},{353.6395`,-8.8529`},{357.3331`,-8.4405`}};
	)
];


(* ::Subsubsection::Closed:: *)
(*AdvancedAnalyzePeaksPreview*)


DefineTests[AdvancedAnalyzePeaksPreview, {

	Example[{Basic, "Generate preview for chromatography data:"},
		AdvancedAnalyzePeaksPreview[Object[Data, Chromatography, "id:XnlV5jmbk0rn"]],
		_DynamicModule
	],

	Example[{Basic,"Generate previews for list of chromatography datas:"},
		AdvancedAnalyzePeaksPreview[{Object[Data, Chromatography, "id:XnlV5jmbk0rn"],Object[Data, Chromatography, "id:XnlV5jmbk0rn"],Object[Data, Chromatography, "id:XnlV5jmbk0rn"]}],
		_DynamicModule
	],

	Example[{Basic, "Generate preview for raw numeric data:"},
		AdvancedAnalyzePeaksPreview[xyPts],
		_DynamicModule
	]},

	Variables:>{xyPts},
	SetUp:>(
		xyPts={{-60.4703`,1.587`},{-59.8914`,-2.9288`},{-59.3126`,-2.8543`},{-58.7337`,-3.6064`},{-58.1548`,-3.5293`},{-57.5759`,-7.4673`},{-56.9971`,0.8248`},{-56.4182`,23.293`},{-55.8393`,0.3193`},{-55.2604`,-13.9593`},{-54.6816`,-12.3607`},{-54.1027`,-3.2422`},{-53.5238`,-4.832`},{-52.9449`,-8.3469`},{-52.3661`,-14.6887`},{-51.7872`,-17.8354`},{-51.2083`,-11.4492`},{-50.6294`,-13.8761`},{-50.0505`,-7.6376`},{-49.4717`,-20.6722`},{-48.8928`,-6.1023`},{-48.3139`,-3.0062`},{-47.735`,6.8016`},{-47.1562`,23.4155`},{-46.5773`,0.9423`},{-45.9984`,19.5976`},{-45.4195`,0.8777`},{-44.8407`,2.3731`},{-44.2618`,16.3106`},{-43.6829`,4.7338`},{-43.104`,7.0143`},{-42.5252`,-0.4604`},{-41.9463`,16.6188`},{-41.3674`,-7.5774`},{-40.7885`,4.786`},{-40.2096`,9.1225`},{-39.6308`,6.0894`},{-39.0519`,8.1521`},{-38.473`,0.7713`},{-37.8941`,24.0671`},{-37.3153`,-5.3851`},{-36.7364`,7.6461`},{-36.1575`,6.2401`},{-35.5786`,5.5707`},{-34.9998`,-3.8426`},{-34.4209`,-8.1403`},{-33.842`,4.7625`},{-33.2631`,-11.033`},{-32.6843`,-10.0288`},{-32.1054`,-9.4915`},{-31.5265`,6.0948`},{-30.9476`,22.7781`},{-30.3687`,-18.0986`},{-29.7899`,-5.7582`},{-29.211`,-7.9967`},{-28.6321`,17.574`},{-28.0532`,9.6356`},{-27.4744`,-12.3885`},{-26.8955`,-9.992`},{-26.3166`,-8.0265`},{-25.7377`,-6.8299`},{-25.1589`,-8.0575`},{-24.58`,9.9059`},{-24.0011`,4.6671`},{-23.4222`,29.4874`},{-22.8434`,-5.0773`},{-22.2645`,3.1678`},{-21.6856`,-3.0654`},{-21.1067`,-4.1394`},{-20.5278`,-12.4577`},{-19.949`,-7.0589`},{-19.3701`,-10.7888`},{-18.7912`,4.4065`},{-18.2123`,5.4024`},{-17.6335`,6.2734`},{-17.0546`,-4.4128`},{-16.4757`,9.1531`},{-15.8968`,-17.4617`},{-15.318`,-5.7665`},{-14.7391`,-8.6346`},{-14.1602`,-1.6776`},{-13.5813`,5.549`},{-13.0025`,-1.2764`},{-12.4236`,1.6277`},{-11.8447`,-6.2084`},{-11.2658`,5.6592`},{-10.6869`,4.7049`},{-10.1081`,8.8459`},{-9.5292`,-5.952`},{-8.9503`,14.4889`},{-8.3714`,23.2175`},{-7.7926`,21.225`},{-7.2137`,15.7654`},{-6.6348`,-2.578`},{-6.0559`,8.965`},{-5.4771`,-9.7285`},{-4.8982`,-2.9533`},{-4.3193`,75.6051`},{-3.7404`,16.4113`},{-3.1616`,14.9865`},{-2.5827`,-11.3331`},{-2.0038`,-2.0928`},{-1.4249`,-0.9202`},{-0.846`,0.2394`},{-0.2672`,6.0783`},{0.3117`,12.7922`},{0.8906`,149.8234`},{1.4695`,137.478`},{2.0483`,73.5309`},{2.6272`,20.1371`},{3.2061`,13.3703`},{3.785`,-1.6624`},{4.3638`,-5.3309`},{4.9427`,6.2866`},{5.5216`,-4.5244`},{6.1005`,-15.892`},{6.6793`,-17.247`},{7.2582`,-3.521`},{7.8371`,47.9696`},{8.416`,48.6575`},{8.9949`,143.0855`},{9.5737`,262.487`},{10.1526`,433.1576`},{10.7315`,655.7522`},{11.3104`,789.8354`},{11.8892`,812.2174`},{12.4681`,768.5621`},{13.047`,657.1636`},{13.6259`,473.0125`},{14.2047`,347.134`},{14.7836`,228.5908`},{15.3625`,146.17`},{15.9414`,77.1921`},{16.5202`,93.6922`},{17.0991`,41.6889`},{17.678`,34.9402`},{18.2569`,24.9377`},{18.8358`,6.303`},{19.4146`,7.6878`},{19.9935`,-0.4913`},{20.5724`,4.309`},{21.1513`,7.6213`},{21.7301`,14.0376`},{22.309`,10.5065`},{22.8879`,-5.2162`},{23.4668`,3.6696`},{24.0456`,-1.3919`},{24.6245`,13.7266`},{25.2034`,26.7292`},{25.7823`,-0.9272`},{26.3611`,-5.163`},{26.94`,-2.0984`},{27.5189`,-4.7001`},{28.0978`,-15.0261`},{28.6767`,-6.6703`},{29.2555`,-4.7324`},{29.8344`,-9.1476`},{30.4133`,-11.197`},{30.9922`,-18.8589`},{31.571`,-18.5209`},{32.1499`,-7.7127`},{32.7288`,-17.283`},{33.3077`,10.2485`},{33.8865`,0.7054`},{34.4654`,17.6433`},{35.0443`,26.3025`},{35.6232`,-4.1029`},{36.202`,9.6538`},{36.7809`,50.4171`},{37.3598`,71.2644`},{37.9387`,193.1155`},{38.5176`,510.2275`},{39.0964`,954.8649`},{39.6753`,1316.5008`},{40.5055`,1341.1692`},{41.6568`,1026.4138`},{42.8081`,549.0985`},{43.9595`,223.7178`},{45.1108`,34.8255`},{46.2621`,-25.6132`},{47.4134`,-69.3664`},{48.5647`,-100.2309`},{49.716`,-90.0365`},{50.8673`,-110.048`},{52.0186`,-89.8928`},{53.1699`,-70.6448`},{54.3212`,-66.6014`},{55.4725`,-7.3808`},{56.6238`,24.2758`},{57.7751`,44.6924`},{58.9264`,89.7889`},{60.0777`,151.1335`},{61.229`,290.8439`},{62.3803`,536.4023`},{63.5317`,956.7083`},{64.683`,1382.7361`},{65.8685`,1552.8259`},{68.4379`,1408.1517`},{71.2857`,1056.4687`},{74.1335`,772.6727`},{76.9813`,502.9082`},{79.8291`,456.0177`},{82.6769`,597.0413`},{85.5247`,933.6729`},{88.3726`,1140.7761`},{91.3774`,1132.9723`},{94.5917`,934.8548`},{97.8059`,695.1553`},{101.0202`,506.9661`},{104.2344`,526.7152`},{107.4487`,886.2472`},{110.6629`,1485.9208`},{113.8772`,1962.2649`},{117.2542`,1986.5373`},{120.9477`,1602.6262`},{124.6412`,1052.4658`},{128.3347`,520.8706`},{132.0283`,237.5131`},{135.7218`,179.6594`},{139.4153`,194.352`},{143.1088`,188.4899`},{146.8023`,193.5516`},{150.4959`,149.3122`},{154.1894`,68.9806`},{157.8829`,26.3029`},{161.5764`,32.2454`},{165.2699`,82.5101`},{168.9635`,171.1333`},{172.657`,342.7152`},{176.3505`,529.9803`},{180.044`,653.1731`},{183.7376`,523.2293`},{187.4311`,361.8707`},{191.1246`,167.4945`},{194.8181`,61.7772`},{198.5116`,60.4075`},{202.2052`,35.8679`},{205.8987`,44.0184`},{209.5922`,65.031`},{213.2857`,95.5418`},{216.9792`,120.0814`},{220.6728`,175.8616`},{224.3663`,244.9024`},{228.0598`,308.0053`},{231.7533`,342.9063`},{235.4469`,388.0488`},{239.1404`,402.7888`},{242.8339`,364.4319`},{246.5274`,337.8086`},{250.2209`,229.8374`},{253.9145`,156.6267`},{257.608`,33.2384`},{261.3015`,-62.4133`},{264.995`,-107.0692`},{268.6885`,-145.7654`},{272.3821`,-167.8836`},{276.0756`,-174.4012`},{279.7691`,-160.7985`},{283.4626`,-94.334`},{287.1562`,-132.8897`},{290.8497`,-88.0442`},{294.5432`,-24.0263`},{298.2367`,17.0242`},{301.9302`,39.8069`},{305.6238`,53.6636`},{309.3173`,58.9873`},{313.0108`,23.7347`},{316.7043`,-15.399`},{320.3978`,-13.7185`},{324.0914`,-29.1139`},{327.7849`,-37.6242`},{331.4784`,-40.0249`},{335.1719`,-26.3684`},{338.8654`,-21.9221`},{342.559`,-23.7979`},{346.2525`,-14.4608`},{349.946`,-0.908`},{353.6395`,-8.8529`},{357.3331`,-8.4405`}};
		coarsePeaks = N@{{0.,0}, {1., 0}, {2., 1.}, {3.,   0}, {4.,0}, {5., 0}, {6., 1.}, {7.,  2}, {8., 0}, {9., 0}};
	)
];


(* ::Subsubsection::Closed:: *)
(*ValidAdvancedAnalyzePeaksQ*)


DefineTests[ValidAdvancedAnalyzePeaksQ, {

	Example[{Basic, "Validate input for chromatography data:"},
		ValidAdvancedAnalyzePeaksQ[Object[Data,Chromatography,"id:vXl9j57qJwZB"]],
		True
	],

	Example[{Basic,"Validate input for list of chromatography datas:"},
		ValidAdvancedAnalyzePeaksQ[{Object[Data,Chromatography,"id:6V0npvmKkO9Z"],Object[Data,Chromatography,"id:9RdZXv1KmoGX"],Object[Data,Chromatography,"id:M8n3rx0YeZp8"]}],
		True
	],

	Example[{Basic, "Validate input for raw numeric data:"},
		ValidAdvancedAnalyzePeaksQ[xyPts],
		True
	],
	Example[{Options, OutputFormat, "Return an EmeraldTestSummary:"},
		ValidAdvancedAnalyzePeaksQ[Object[Data,Chromatography,"id:vXl9j57qJwZB"], OutputFormat->TestSummary],
		_EmeraldTestSummary
	],
	Example[{Options, Verbose, "Print verbose messages reporting test passage / failure:"},
		ValidAdvancedAnalyzePeaksQ[Object[Data,Chromatography,"id:vXl9j57qJwZB"], Verbose->True],
		True
	]
	},

	Variables:>{xyPts},
	SetUp:>(
		xyPts={{-60.4703`,1.587`},{-59.8914`,-2.9288`},{-59.3126`,-2.8543`},{-58.7337`,-3.6064`},{-58.1548`,-3.5293`},{-57.5759`,-7.4673`},{-56.9971`,0.8248`},{-56.4182`,23.293`},{-55.8393`,0.3193`},{-55.2604`,-13.9593`},{-54.6816`,-12.3607`},{-54.1027`,-3.2422`},{-53.5238`,-4.832`},{-52.9449`,-8.3469`},{-52.3661`,-14.6887`},{-51.7872`,-17.8354`},{-51.2083`,-11.4492`},{-50.6294`,-13.8761`},{-50.0505`,-7.6376`},{-49.4717`,-20.6722`},{-48.8928`,-6.1023`},{-48.3139`,-3.0062`},{-47.735`,6.8016`},{-47.1562`,23.4155`},{-46.5773`,0.9423`},{-45.9984`,19.5976`},{-45.4195`,0.8777`},{-44.8407`,2.3731`},{-44.2618`,16.3106`},{-43.6829`,4.7338`},{-43.104`,7.0143`},{-42.5252`,-0.4604`},{-41.9463`,16.6188`},{-41.3674`,-7.5774`},{-40.7885`,4.786`},{-40.2096`,9.1225`},{-39.6308`,6.0894`},{-39.0519`,8.1521`},{-38.473`,0.7713`},{-37.8941`,24.0671`},{-37.3153`,-5.3851`},{-36.7364`,7.6461`},{-36.1575`,6.2401`},{-35.5786`,5.5707`},{-34.9998`,-3.8426`},{-34.4209`,-8.1403`},{-33.842`,4.7625`},{-33.2631`,-11.033`},{-32.6843`,-10.0288`},{-32.1054`,-9.4915`},{-31.5265`,6.0948`},{-30.9476`,22.7781`},{-30.3687`,-18.0986`},{-29.7899`,-5.7582`},{-29.211`,-7.9967`},{-28.6321`,17.574`},{-28.0532`,9.6356`},{-27.4744`,-12.3885`},{-26.8955`,-9.992`},{-26.3166`,-8.0265`},{-25.7377`,-6.8299`},{-25.1589`,-8.0575`},{-24.58`,9.9059`},{-24.0011`,4.6671`},{-23.4222`,29.4874`},{-22.8434`,-5.0773`},{-22.2645`,3.1678`},{-21.6856`,-3.0654`},{-21.1067`,-4.1394`},{-20.5278`,-12.4577`},{-19.949`,-7.0589`},{-19.3701`,-10.7888`},{-18.7912`,4.4065`},{-18.2123`,5.4024`},{-17.6335`,6.2734`},{-17.0546`,-4.4128`},{-16.4757`,9.1531`},{-15.8968`,-17.4617`},{-15.318`,-5.7665`},{-14.7391`,-8.6346`},{-14.1602`,-1.6776`},{-13.5813`,5.549`},{-13.0025`,-1.2764`},{-12.4236`,1.6277`},{-11.8447`,-6.2084`},{-11.2658`,5.6592`},{-10.6869`,4.7049`},{-10.1081`,8.8459`},{-9.5292`,-5.952`},{-8.9503`,14.4889`},{-8.3714`,23.2175`},{-7.7926`,21.225`},{-7.2137`,15.7654`},{-6.6348`,-2.578`},{-6.0559`,8.965`},{-5.4771`,-9.7285`},{-4.8982`,-2.9533`},{-4.3193`,75.6051`},{-3.7404`,16.4113`},{-3.1616`,14.9865`},{-2.5827`,-11.3331`},{-2.0038`,-2.0928`},{-1.4249`,-0.9202`},{-0.846`,0.2394`},{-0.2672`,6.0783`},{0.3117`,12.7922`},{0.8906`,149.8234`},{1.4695`,137.478`},{2.0483`,73.5309`},{2.6272`,20.1371`},{3.2061`,13.3703`},{3.785`,-1.6624`},{4.3638`,-5.3309`},{4.9427`,6.2866`},{5.5216`,-4.5244`},{6.1005`,-15.892`},{6.6793`,-17.247`},{7.2582`,-3.521`},{7.8371`,47.9696`},{8.416`,48.6575`},{8.9949`,143.0855`},{9.5737`,262.487`},{10.1526`,433.1576`},{10.7315`,655.7522`},{11.3104`,789.8354`},{11.8892`,812.2174`},{12.4681`,768.5621`},{13.047`,657.1636`},{13.6259`,473.0125`},{14.2047`,347.134`},{14.7836`,228.5908`},{15.3625`,146.17`},{15.9414`,77.1921`},{16.5202`,93.6922`},{17.0991`,41.6889`},{17.678`,34.9402`},{18.2569`,24.9377`},{18.8358`,6.303`},{19.4146`,7.6878`},{19.9935`,-0.4913`},{20.5724`,4.309`},{21.1513`,7.6213`},{21.7301`,14.0376`},{22.309`,10.5065`},{22.8879`,-5.2162`},{23.4668`,3.6696`},{24.0456`,-1.3919`},{24.6245`,13.7266`},{25.2034`,26.7292`},{25.7823`,-0.9272`},{26.3611`,-5.163`},{26.94`,-2.0984`},{27.5189`,-4.7001`},{28.0978`,-15.0261`},{28.6767`,-6.6703`},{29.2555`,-4.7324`},{29.8344`,-9.1476`},{30.4133`,-11.197`},{30.9922`,-18.8589`},{31.571`,-18.5209`},{32.1499`,-7.7127`},{32.7288`,-17.283`},{33.3077`,10.2485`},{33.8865`,0.7054`},{34.4654`,17.6433`},{35.0443`,26.3025`},{35.6232`,-4.1029`},{36.202`,9.6538`},{36.7809`,50.4171`},{37.3598`,71.2644`},{37.9387`,193.1155`},{38.5176`,510.2275`},{39.0964`,954.8649`},{39.6753`,1316.5008`},{40.5055`,1341.1692`},{41.6568`,1026.4138`},{42.8081`,549.0985`},{43.9595`,223.7178`},{45.1108`,34.8255`},{46.2621`,-25.6132`},{47.4134`,-69.3664`},{48.5647`,-100.2309`},{49.716`,-90.0365`},{50.8673`,-110.048`},{52.0186`,-89.8928`},{53.1699`,-70.6448`},{54.3212`,-66.6014`},{55.4725`,-7.3808`},{56.6238`,24.2758`},{57.7751`,44.6924`},{58.9264`,89.7889`},{60.0777`,151.1335`},{61.229`,290.8439`},{62.3803`,536.4023`},{63.5317`,956.7083`},{64.683`,1382.7361`},{65.8685`,1552.8259`},{68.4379`,1408.1517`},{71.2857`,1056.4687`},{74.1335`,772.6727`},{76.9813`,502.9082`},{79.8291`,456.0177`},{82.6769`,597.0413`},{85.5247`,933.6729`},{88.3726`,1140.7761`},{91.3774`,1132.9723`},{94.5917`,934.8548`},{97.8059`,695.1553`},{101.0202`,506.9661`},{104.2344`,526.7152`},{107.4487`,886.2472`},{110.6629`,1485.9208`},{113.8772`,1962.2649`},{117.2542`,1986.5373`},{120.9477`,1602.6262`},{124.6412`,1052.4658`},{128.3347`,520.8706`},{132.0283`,237.5131`},{135.7218`,179.6594`},{139.4153`,194.352`},{143.1088`,188.4899`},{146.8023`,193.5516`},{150.4959`,149.3122`},{154.1894`,68.9806`},{157.8829`,26.3029`},{161.5764`,32.2454`},{165.2699`,82.5101`},{168.9635`,171.1333`},{172.657`,342.7152`},{176.3505`,529.9803`},{180.044`,653.1731`},{183.7376`,523.2293`},{187.4311`,361.8707`},{191.1246`,167.4945`},{194.8181`,61.7772`},{198.5116`,60.4075`},{202.2052`,35.8679`},{205.8987`,44.0184`},{209.5922`,65.031`},{213.2857`,95.5418`},{216.9792`,120.0814`},{220.6728`,175.8616`},{224.3663`,244.9024`},{228.0598`,308.0053`},{231.7533`,342.9063`},{235.4469`,388.0488`},{239.1404`,402.7888`},{242.8339`,364.4319`},{246.5274`,337.8086`},{250.2209`,229.8374`},{253.9145`,156.6267`},{257.608`,33.2384`},{261.3015`,-62.4133`},{264.995`,-107.0692`},{268.6885`,-145.7654`},{272.3821`,-167.8836`},{276.0756`,-174.4012`},{279.7691`,-160.7985`},{283.4626`,-94.334`},{287.1562`,-132.8897`},{290.8497`,-88.0442`},{294.5432`,-24.0263`},{298.2367`,17.0242`},{301.9302`,39.8069`},{305.6238`,53.6636`},{309.3173`,58.9873`},{313.0108`,23.7347`},{316.7043`,-15.399`},{320.3978`,-13.7185`},{324.0914`,-29.1139`},{327.7849`,-37.6242`},{331.4784`,-40.0249`},{335.1719`,-26.3684`},{338.8654`,-21.9221`},{342.559`,-23.7979`},{346.2525`,-14.4608`},{349.946`,-0.908`},{353.6395`,-8.8529`},{357.3331`,-8.4405`}};
	)
];


(* ::Section:: *)
(*End Test Package*)
