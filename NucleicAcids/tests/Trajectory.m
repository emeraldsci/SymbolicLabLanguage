

(* ::Text:: *)
(*\[Copyright] 2011-2023 Emerald Cloud Lab, Inc.*)

(* ::Package:: *)

(* ::Title:: *)
(*Trajectory: Tests*)








(* ::Section:: *)
(*Unit Testing*)


(* ::Subsection:: *)
(*Trajectory*)


(* ::Subsubsection::Closed:: *)
(*Trajectory*)


DefineTests[Trajectory,
	{
		Example[{Basic,"A trajectory of concentration vs time:"},
			Trajectory[{"a","b"},{{1.,0},{0.9,0.1},{0.7,0.3},{0.4,0.6},{0.1,0.9}},{0.,1.,2.,3.,4.},{Second,Micromolar}],
			TrajectoryP
		],

		Example[{Basic,"Visualize the trajectory:"},
			PlotTrajectory[traj],
			ValidGraphicsP[]
		],


		Example[{Basic,"Extract the coordinates for a single species, as concentrtion vs time:"},
			Trajectory[{"a","b"},{{1.,0},{0.9,0.1},{0.7,0.3},{0.4,0.6},{0.1,0.9}},{0.,1.,2.,3.,4.},{Second,Micromolar}]["b"],
			QuantityCoordinatesP[{Second,Micromolar}]
		],

		Example[{Basic,"Evaluate the concentration at a specific time:"},
			Trajectory[{"a","b"},{{1.,0},{0.9,0.1},{0.7,0.3},{0.4,0.6},{0.1,0.9}},{0.,1.,2.,3.,4.},{Second,Micromolar}]["b",4Second],
			0.9*Micromolar
		],

		Example[{Basic,"A trajectory of amount vs temperature:"},
			Trajectory[{"a","b"},{{1.,0},{0.9,0.1},{0.7,0.3},{0.4,0.6},{0.1,0.9}},{20,40,60,80,100},{Celsius,Nanomole}],
			TrajectoryP
		],

		Example[{Additional,"Properties","Pull species from a trajectory:"},
			traj[Species],
			{Structure[{Strand[DNA["GGATTAGTCTGTACTGCAGAAGCTA"]]}, {}], Structure[{Strand[DNA["TAGCTTCTGCAGTACAGACTAATCC"]]}, {}], Structure[{Strand[DNA["GGATTAGTCTGTACTGCAGAAGCTA"]], Strand[DNA["TAGCTTCTGCAGTACAGACTAATCC"]]}, {Bond[{1, 1, 1 ;; 25}, {2, 1, 1 ;; 25}]}], Structure[{Strand[DNA["GGATTAGTCTGTACTGCAGAAGCTA"]], Strand[DNA["GGATTAGTCTGTACTGCAGAAGCTA"]]}, {Bond[{1, 1, 14 ;; 19}, {2, 1, 14 ;; 19}]}], Structure[{Strand[DNA["GGATTAGTCTGTACTGCAGAAGCTA"]]}, {Bond[{1, 1, 8 ;; 11}, {1, 1, 17 ;; 20}]}], Structure[{Strand[DNA["TAGCTTCTGCAGTACAGACTAATCC"]], Strand[DNA["TAGCTTCTGCAGTACAGACTAATCC"]]}, {Bond[{1, 1, 7 ;; 12}, {2, 1, 7 ;; 12}]}], Structure[{Strand[DNA["TAGCTTCTGCAGTACAGACTAATCC"]]}, {Bond[{1, 1, 6 ;; 9}, {1, 1, 15 ;; 18}]}]}
		],


		Example[{Additional,"Properties","Pull the coordinates of a species in the form of {time,concentration} coordinates:"},
			Trajectory[{"a","b"},{{1.,0},{0.9,0.1},{0.7,0.3},{0.4,0.6},{0.1,0.9}},{0.,1.,2.,3.,4.},{Second,Micromolar}]["a"],
			QuantityArray[{{Quantity[0., "Seconds"],
				Quantity[1., "Micromolar"]},
				{Quantity[1., "Seconds"],
					Quantity[0.9, "Micromolar"]},
				{Quantity[2., "Seconds"],
					Quantity[0.7, "Micromolar"]},
				{Quantity[3., "Seconds"],
					Quantity[0.4, "Micromolar"]},
				{Quantity[4., "Seconds"],
					Quantity[0.1, "Micromolar"]}}]
		],
		Example[{Additional,"Properties","Pull the concentration of a species at a single time:"},
			Trajectory[{"a","b"},{{1.,0},{0.9,0.1},{0.7,0.3},{0.4,0.6},{0.1,0.9}},{0.,1.,2.,3.,4.},{Second,Micromolar}]["a",2Second],
			Quantity[0.7, "Micromolar"]
		],
		Example[{Additional,"Properties","Pull the coordinates of a multiple species, to get a set of coordinates:"},
			Trajectory[{"a","b"},{{1.,0},{0.9,0.1},{0.7,0.3},{0.4,0.6},{0.1,0.9}},{0.,1.,2.,3.,4.},{Second,Micromolar}][{"a","b"}],
QuantityArray[{{{Quantity[0., "Seconds"],
	Quantity[1., "Micromolar"]},
	{Quantity[1., "Seconds"],
		Quantity[0.9, "Micromolar"]},
	{Quantity[2., "Seconds"],
		Quantity[0.7, "Micromolar"]},
	{Quantity[3., "Seconds"],
		Quantity[0.4, "Micromolar"]},
	{Quantity[4., "Seconds"],
		Quantity[0.1, "Micromolar"]}},
	{{Quantity[0., "Seconds"],
		Quantity[0., "Micromolar"]},
		{Quantity[1., "Seconds"],
			Quantity[0.1, "Micromolar"]},
		{Quantity[2., "Seconds"],
			Quantity[0.3, "Micromolar"]},
		{Quantity[3., "Seconds"],
			Quantity[0.6, "Micromolar"]},
		{Quantity[4., "Seconds"],
			Quantity[0.9, "Micromolar"]}}}]
		],


		Example[{Additional,"Properties","Pull units of a trajectory:"},
			traj[Units],
			{Second,Molar}
		],
		Example[{Additional,"Properties","Pull the {time,concentration} coordinates of a trajectory:"},
			traj[Coordinates],
			{Repeated[CoordinatesP,{7}]}
		],
		Example[{Additional,"Properties","Pull the times of a trajectory:"},
			traj[Time],
			{_?NumericQ..}
		],
		Example[{Additional,"Properties","Pull the concentrations of a trajectory:"},
			traj[Concentration],
			{{_?NumericQ..}..}
		],

		Example[{Additional,"Subspecies Trajectory","Construct a trajectory containing only the species b from the original trajectory:"},
			Trajectory[Trajectory[{"a", "b","c"}, {{1., 0, 2.}, {0.9, 0.1, 2.2}, {0.7, 0.3, 2.3}, {0.4, 0.6,2.4}, {0.1, 0.9, 2.5}}, {0., 1., 2., 3., 4.}, {Second,Micromolar}], "b"],
			Trajectory[{"b"}, {{0}, {0.1}, {0.3}, {0.6}, {0.9}}, {0., 1., 2., 3., 4.}, {Quantity[1, "Seconds"], Quantity[1, "Micromolar"]}]
		],
		Example[{Additional,"Subspecies Trajectory","Construct a trajectory containing only the first and third species from the original trajectory:"},
			Trajectory[Trajectory[{"a", "b","c"}, {{1., 0, 2.}, {0.9, 0.1, 2.2}, {0.7, 0.3, 2.3}, {0.4, 0.6,2.4}, {0.1, 0.9, 2.5}}, {0., 1., 2., 3., 4.}, {Second,Micromolar}], {1,3}],
			Trajectory[{"a", "c"}, {{1., 2.}, {0.9, 2.2}, {0.7, 2.3}, {0.4, 2.4}, {0.1, 2.5}}, {0., 1., 2., 3., 4.}, {Quantity[1, "Seconds"], Quantity[1, "Micromolar"]}]
		],
		Example[{Messages,"BadSpecies","Returns $Failed when given subspecies that does not exist in the trajectory:"},
			Trajectory[Trajectory[{"a", "b","c"}, {{1., 0, 2.}, {0.9, 0.1, 2.2}, {0.7, 0.3, 2.3}, {0.4, 0.6,2.4}, {0.1, 0.9, 2.5}}, {0., 1., 2., 3., 4.}, {Second,Micromolar}], "d"],
			$Failed,
			Messages:>{Trajectory::BadSpecies}
		]

	},

	Variables:>{traj},
	SetUp:>{
		traj=Trajectory[
			{Structure[{Strand[DNA["GGATTAGTCTGTACTGCAGAAGCTA"]]}, {}], Structure[{Strand[DNA["TAGCTTCTGCAGTACAGACTAATCC"]]}, {}], Structure[{Strand[DNA["GGATTAGTCTGTACTGCAGAAGCTA"]], Strand[DNA["TAGCTTCTGCAGTACAGACTAATCC"]]}, {Bond[{1, 1, 1 ;; 25}, {2, 1, 1 ;; 25}]}], Structure[{Strand[DNA["GGATTAGTCTGTACTGCAGAAGCTA"]], Strand[DNA["GGATTAGTCTGTACTGCAGAAGCTA"]]}, {Bond[{1, 1, 14 ;; 19}, {2, 1, 14 ;; 19}]}], Structure[{Strand[DNA["GGATTAGTCTGTACTGCAGAAGCTA"]]}, {Bond[{1, 1, 8 ;; 11}, {1, 1, 17 ;; 20}]}], Structure[{Strand[DNA["TAGCTTCTGCAGTACAGACTAATCC"]], Strand[DNA["TAGCTTCTGCAGTACAGACTAATCC"]]}, {Bond[{1, 1, 7 ;; 12}, {2, 1, 7 ;; 12}]}], Structure[{Strand[DNA["TAGCTTCTGCAGTACAGACTAATCC"]]}, {Bond[{1, 1, 6 ;; 9}, {1, 1, 15 ;; 18}]}]},
			{{1.`*^-6,1.`*^-6,0.`,0.`,0.`,0.`,0.`},{9.979`*^-7,9.979`*^-7,4.193`*^-10,4.048`*^-10,8.396`*^-10,4.048`*^-10,8.396`*^-10},{9.869`*^-7,9.869`*^-7,2.853`*^-9,2.255`*^-9,5.744`*^-9,2.255`*^-9,5.744`*^-9},{9.681`*^-7,9.681`*^-7,7.745`*^-9,4.216`*^-9,1.575`*^-8,4.216`*^-9,1.575`*^-8},{9.405`*^-7,9.405`*^-7,1.609`*^-8,5.112`*^-9,3.323`*^-8,5.112`*^-9,3.323`*^-8},{9.145`*^-7,9.145`*^-7,2.435`*^-8,5.07`*^-9,5.102`*^-8,5.07`*^-9,5.102`*^-8},{8.854`*^-7,8.854`*^-7,3.357`*^-8,4.799`*^-9,7.146`*^-8,4.799`*^-9,7.146`*^-8},{8.508`*^-7,8.508`*^-7,4.427`*^-8,4.437`*^-9,9.604`*^-8,4.437`*^-9,9.604`*^-8},{8.132`*^-7,8.132`*^-7,5.559`*^-8,4.052`*^-9,1.231`*^-7,4.052`*^-9,1.231`*^-7},{7.615`*^-7,7.615`*^-7,7.054`*^-8,3.551`*^-9,1.609`*^-7,3.551`*^-9,1.609`*^-7},{7.271`*^-7,7.271`*^-7,8.01`*^-8,3.236`*^-9,1.863`*^-7,3.236`*^-9,1.863`*^-7},{6.811`*^-7,6.811`*^-7,9.238`*^-8,2.838`*^-9,2.209`*^-7,2.838`*^-9,2.209`*^-7},{6.385`*^-7,6.385`*^-7,1.032`*^-7,2.492`*^-9,2.533`*^-7,2.492`*^-9,2.533`*^-7},{6.005`*^-7,6.005`*^-7,1.124`*^-7,2.203`*^-9,2.826`*^-7,2.203`*^-9,2.826`*^-7},{5.657`*^-7,5.657`*^-7,1.205`*^-7,1.954`*^-9,3.099`*^-7,1.954`*^-9,3.099`*^-7},{5.338`*^-7,5.338`*^-7,1.276`*^-7,1.739`*^-9,3.351`*^-7,1.739`*^-9,3.351`*^-7},{5.042`*^-7,5.042`*^-7,1.339`*^-7,1.552`*^-9,3.588`*^-7,1.552`*^-9,3.588`*^-7},{4.769`*^-7,4.769`*^-7,1.395`*^-7,1.387`*^-9,3.809`*^-7,1.387`*^-9,3.809`*^-7},{4.514`*^-7,4.514`*^-7,1.444`*^-7,1.243`*^-9,4.017`*^-7,1.243`*^-9,4.017`*^-7},{4.277`*^-7,4.277`*^-7,1.489`*^-7,1.115`*^-9,4.212`*^-7,1.115`*^-9,4.212`*^-7},{4.056`*^-7,4.056`*^-7,1.529`*^-7,1.002`*^-9,4.396`*^-7,1.002`*^-9,4.396`*^-7},{3.848`*^-7,3.848`*^-7,1.564`*^-7,9.021`*^-10,4.569`*^-7,9.021`*^-10,4.569`*^-7},{3.654`*^-7,3.654`*^-7,1.596`*^-7,8.13`*^-10,4.733`*^-7,8.13`*^-10,4.733`*^-7},{3.471`*^-7,3.471`*^-7,1.625`*^-7,7.336`*^-10,4.889`*^-7,7.336`*^-10,4.889`*^-7},{3.3`*^-7,3.3`*^-7,1.652`*^-7,6.627`*^-10,5.035`*^-7,6.627`*^-10,5.035`*^-7},{3.138`*^-7,3.138`*^-7,1.675`*^-7,5.992`*^-10,5.175`*^-7,5.992`*^-10,5.175`*^-7},{2.986`*^-7,2.986`*^-7,1.697`*^-7,5.422`*^-10,5.307`*^-7,5.422`*^-10,5.307`*^-7},{2.842`*^-7,2.842`*^-7,1.716`*^-7,4.911`*^-10,5.432`*^-7,4.911`*^-10,5.432`*^-7},{2.706`*^-7,2.706`*^-7,1.734`*^-7,4.451`*^-10,5.551`*^-7,4.451`*^-10,5.551`*^-7},{2.577`*^-7,2.577`*^-7,1.75`*^-7,4.036`*^-10,5.664`*^-7,4.036`*^-10,5.664`*^-7},{2.455`*^-7,2.455`*^-7,1.765`*^-7,3.662`*^-10,5.772`*^-7,3.662`*^-10,5.772`*^-7},{2.339`*^-7,2.339`*^-7,1.779`*^-7,3.324`*^-10,5.875`*^-7,3.324`*^-10,5.875`*^-7},{2.23`*^-7,2.23`*^-7,1.791`*^-7,3.019`*^-10,5.974`*^-7,3.019`*^-10,5.974`*^-7},{2.125`*^-7,2.125`*^-7,1.802`*^-7,2.741`*^-10,6.067`*^-7,2.741`*^-10,6.067`*^-7},{2.025`*^-7,2.025`*^-7,1.813`*^-7,2.49`*^-10,6.157`*^-7,2.49`*^-10,6.157`*^-7},{1.93`*^-7,1.93`*^-7,1.822`*^-7,2.261`*^-10,6.243`*^-7,2.261`*^-10,6.243`*^-7},{1.84`*^-7,1.84`*^-7,1.831`*^-7,2.053`*^-10,6.325`*^-7,2.053`*^-10,6.325`*^-7},{1.753`*^-7,1.753`*^-7,1.839`*^-7,1.864`*^-10,6.404`*^-7,1.864`*^-10,6.404`*^-7},{1.67`*^-7,1.67`*^-7,1.847`*^-7,1.691`*^-10,6.48`*^-7,1.691`*^-10,6.48`*^-7},{1.59`*^-7,1.59`*^-7,1.853`*^-7,1.533`*^-10,6.553`*^-7,1.533`*^-10,6.553`*^-7},{1.514`*^-7,1.514`*^-7,1.86`*^-7,1.389`*^-10,6.623`*^-7,1.389`*^-10,6.623`*^-7},{1.441`*^-7,1.441`*^-7,1.866`*^-7,1.257`*^-10,6.691`*^-7,1.257`*^-10,6.691`*^-7},{1.37`*^-7,1.37`*^-7,1.871`*^-7,1.136`*^-10,6.757`*^-7,1.136`*^-10,6.757`*^-7},{1.302`*^-7,1.302`*^-7,1.876`*^-7,1.026`*^-10,6.82`*^-7,1.026`*^-10,6.82`*^-7},{1.236`*^-7,1.236`*^-7,1.881`*^-7,9.248`*^-11,6.881`*^-7,9.248`*^-11,6.881`*^-7},{1.173`*^-7,1.173`*^-7,1.886`*^-7,8.322`*^-11,6.94`*^-7,8.322`*^-11,6.94`*^-7},{1.112`*^-7,1.112`*^-7,1.89`*^-7,7.476`*^-11,6.997`*^-7,7.476`*^-11,6.997`*^-7},{1.053`*^-7,1.053`*^-7,1.894`*^-7,6.706`*^-11,7.052`*^-7,6.706`*^-11,7.052`*^-7},{9.968`*^-8,9.968`*^-8,1.897`*^-7,6.002`*^-11,7.105`*^-7,6.002`*^-11,7.105`*^-7},{9.427`*^-8,9.427`*^-8,1.901`*^-7,5.367`*^-11,7.156`*^-7,5.367`*^-11,7.156`*^-7},{8.921`*^-8,8.921`*^-8,1.904`*^-7,4.804`*^-11,7.203`*^-7,4.804`*^-11,7.203`*^-7},{8.447`*^-8,8.447`*^-8,1.906`*^-7,4.304`*^-11,7.248`*^-7,4.304`*^-11,7.248`*^-7},{8.041`*^-8,8.041`*^-8,1.909`*^-7,3.898`*^-11,7.287`*^-7,3.898`*^-11,7.287`*^-7},{7.657`*^-8,7.657`*^-8,1.911`*^-7,3.534`*^-11,7.323`*^-7,3.534`*^-11,7.323`*^-7},{7.281`*^-8,7.281`*^-8,1.913`*^-7,3.194`*^-11,7.358`*^-7,3.194`*^-11,7.358`*^-7},{7.114`*^-8,7.114`*^-8,1.914`*^-7,3.048`*^-11,7.374`*^-7,3.048`*^-11,7.374`*^-7},{6.727`*^-8,6.727`*^-8,1.916`*^-7,2.724`*^-11,7.411`*^-7,2.724`*^-11,7.411`*^-7},{6.573`*^-8,6.573`*^-8,1.917`*^-7,2.6`*^-11,7.426`*^-7,2.6`*^-11,7.426`*^-7},{6.248`*^-8,6.248`*^-8,1.918`*^-7,2.349`*^-11,7.457`*^-7,2.349`*^-11,7.457`*^-7},{6.113`*^-8,6.113`*^-8,1.919`*^-7,2.247`*^-11,7.469`*^-7,2.247`*^-11,7.469`*^-7},{5.913`*^-8,5.913`*^-8,1.92`*^-7,2.101`*^-11,7.488`*^-7,2.101`*^-11,7.488`*^-7},{5.722`*^-8,5.722`*^-8,1.921`*^-7,1.967`*^-11,7.507`*^-7,1.967`*^-11,7.507`*^-7},{5.611`*^-8,5.611`*^-8,1.921`*^-7,1.891`*^-11,7.517`*^-7,1.891`*^-11,7.517`*^-7},{5.398`*^-8,5.398`*^-8,1.922`*^-7,1.749`*^-11,7.537`*^-7,1.749`*^-11,7.537`*^-7},{5.287`*^-8,5.287`*^-8,1.923`*^-7,1.678`*^-11,7.548`*^-7,1.678`*^-11,7.548`*^-7},{4.964`*^-8,4.964`*^-8,1.925`*^-7,1.477`*^-11,7.579`*^-7,1.477`*^-11,7.579`*^-7},{4.883`*^-8,4.883`*^-8,1.925`*^-7,1.429`*^-11,7.586`*^-7,1.429`*^-11,7.586`*^-7},{4.679`*^-8,4.679`*^-8,1.926`*^-7,1.312`*^-11,7.606`*^-7,1.312`*^-11,7.606`*^-7},{4.589`*^-8,4.589`*^-8,1.927`*^-7,1.262`*^-11,7.614`*^-7,1.262`*^-11,7.614`*^-7},{4.48`*^-8,4.48`*^-8,1.927`*^-7,1.202`*^-11,7.625`*^-7,1.202`*^-11,7.625`*^-7},{4.318`*^-8,4.318`*^-8,1.928`*^-7,1.116`*^-11,7.64`*^-7,1.116`*^-11,7.64`*^-7},{4.256`*^-8,4.256`*^-8,1.928`*^-7,1.084`*^-11,7.646`*^-7,1.084`*^-11,7.646`*^-7},{4.085`*^-8,4.085`*^-8,1.929`*^-7,9.983`*^-12,7.662`*^-7,9.983`*^-12,7.662`*^-7},{4.03`*^-8,4.03`*^-8,1.93`*^-7,9.709`*^-12,7.667`*^-7,9.709`*^-12,7.667`*^-7},{3.967`*^-8,3.967`*^-8,1.93`*^-7,9.402`*^-12,7.673`*^-7,9.402`*^-12,7.673`*^-7},{3.821`*^-8,3.821`*^-8,1.931`*^-7,8.719`*^-12,7.687`*^-7,8.719`*^-12,7.687`*^-7},{3.779`*^-8,3.779`*^-8,1.931`*^-7,8.527`*^-12,7.691`*^-7,8.527`*^-12,7.691`*^-7},{3.621`*^-8,3.621`*^-8,1.932`*^-7,7.829`*^-12,7.706`*^-7,7.829`*^-12,7.706`*^-7},{3.217`*^-8,3.217`*^-8,1.935`*^-7,6.158`*^-12,7.743`*^-7,6.158`*^-12,7.743`*^-7},{2.949`*^-8,2.949`*^-8,1.939`*^-7,5.165`*^-12,7.766`*^-7,5.165`*^-12,7.766`*^-7},{2.805`*^-8,2.805`*^-8,1.942`*^-7,4.662`*^-12,7.778`*^-7,4.662`*^-12,7.778`*^-7},{2.743`*^-8,2.743`*^-8,1.945`*^-7,4.462`*^-12,7.781`*^-7,4.462`*^-12,7.781`*^-7},{2.711`*^-8,2.711`*^-8,1.949`*^-7,4.358`*^-12,7.78`*^-7,4.358`*^-12,7.78`*^-7},{2.698`*^-8,2.698`*^-8,1.955`*^-7,4.313`*^-12,7.776`*^-7,4.313`*^-12,7.776`*^-7},{2.693`*^-8,2.693`*^-8,1.962`*^-7,4.297`*^-12,7.769`*^-7,4.297`*^-12,7.769`*^-7},{2.689`*^-8,2.689`*^-8,1.973`*^-7,4.284`*^-12,7.758`*^-7,4.284`*^-12,7.758`*^-7},{2.677`*^-8,2.677`*^-8,2.007`*^-7,4.249`*^-12,7.725`*^-7,4.249`*^-12,7.725`*^-7},{2.645`*^-8,2.645`*^-8,2.106`*^-7,4.146`*^-12,7.63`*^-7,4.146`*^-12,7.63`*^-7}},
			{0.`,0.0008404`,0.005784`,0.01603`,0.03437`,0.05359`,0.07635`,0.1048`,0.1375`,0.1857`,0.2203`,0.2698`,0.3197`,0.3677`,0.4153`,0.4623`,0.5089`,0.5552`,0.6014`,0.6473`,0.6931`,0.7389`,0.7846`,0.8303`,0.8761`,0.9219`,0.9678`,1.014`,1.06`,1.106`,1.153`,1.2`,1.247`,1.295`,1.343`,1.392`,1.441`,1.492`,1.543`,1.595`,1.648`,1.703`,1.759`,1.816`,1.875`,1.937`,2.`,2.066`,2.135`,2.205`,2.277`,2.35`,2.417`,2.486`,2.559`,2.593`,2.678`,2.715`,2.796`,2.832`,2.888`,2.945`,2.98`,3.051`,3.09`,3.214`,3.249`,3.34`,3.383`,3.439`,3.529`,3.565`,3.674`,3.712`,3.758`,3.872`,3.908`,4.057`,4.6`,5.285`,6.091`,6.897`,7.944`,9.514`,11.58`,14.62`,24.02`,51.87`},
			{Quantity[1, "Seconds"], Quantity[1, "Molar"]}
		]
	}
]


(* ::Section::Closed:: *)
(*End Test Package*)
